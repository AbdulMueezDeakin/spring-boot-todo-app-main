pipeline {
    agent any
    tools {
      maven '3.9.6'
      jdk 'JDK 17'
     }
    stages {
        stage('Build') {
            steps {
                // Build Spring Boot application
                 script {
                    sh 'mvn clean package'
                    archiveArtifacts artifacts: '**/target/*.jar', fingerprint: true
                    //archiveArtifacts artifacts: '**/target/*.jar', fingerprint: true
                }
            }
            post {
                success {
                    echo 'Build succeeded'
                }
                failure {
                    echo 'Build failed'
                }
            }
        }
        stage('Test') {
            steps {
               sh 'mvn test'
            }
             post {
                success {
                    echo 'Test Run successfully'
                }
                failure {
                    echo 'Test Run Failed'
                }
            }
        }
       stage('Code Quality Analysis') {
            steps {
                withSonarQubeEnv('sonarqube2') {
                    sh 'mvn sonar:sonar -Dsonar.projectKey=spring-boot-todo-app -Dsonar.host.url=http://localhost:9000 -Dsonar.login=sqa_70e8ae941c878c39fa59acd7bb961cd1723d3615'
                }
            }
       }
        stage('Deploy') {
            steps {
                // Deploy Spring Boot application (for example, to a Docker container)
                // Example: sh 'docker build -t todo-app .'
                // Example: sh 'docker run -d -p 8080:8080 todo-app'
                echo 'deploy'
            }
        }
        stage('Release') {
            steps {
                // Promote application to production environment (if applicable)
                // Example: sh 'kubectl apply -f deployment.yaml'
                  echo 'release'
            }
        }
        stage('Monitoring and Alerting') {
            steps {
                // Set up monitoring and alerting (if applicable)
                // Example: sh 'configure-datadog'
                echo 'Monitoring and Alerting'
            }
        }
    }
}
